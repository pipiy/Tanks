<html> 
  <head>
    <meta charset = "utf-8">
    <title>HTML5Tank</title>
  </head>
  <body>
    <canvas id="game" style="border: 1px solid #ccc;"></canvas>
    <script>
        var size = 64; // the width of the cell game
        var canvas = document.getElementById("game");
        var context = canvas.getContext("2d");
        canvas.width = 8 * size; // the width of the playing field
        canvas.height = 8 * size; // the height of the playing field

        var TILE_SIZE = 16;
        var cx = 0,
            cy = 0;
        img = new Image();
        img.src = "misc.png";

        var WATER = 1;
        var BRICK = 2;
        var STONE = 3;
        var TREE = 4;
        var LATTICE = 5;
        var ROAD = 6;
        var TANK = 7;
        var FLAG = 8;
        var ENEMY_TANK = 9;

        var map = [
          [6, 6, 4, 4, 6, 6, 6, 6, 6, 6, 4, 4, 4, 6, 6, 6],
          [6, 6, 4, 4, 6, 6, 2, 6, 2, 6, 4, 4, 6, 5, 5, 6],
          [6, 2, 4, 6, 6, 2, 2, 6, 2, 6, 4, 4, 6, 5, 5, 6],
          [6, 2, 4, 3, 6, 9, 2, 6, 2, 6, 4, 4, 6, 5, 5, 6],
          [6, 2, 4, 3, 6, 6, 2, 6, 2, 6, 4, 4, 6, 6, 6, 6],
          [1, 2, 2, 4, 3, 6, 2, 6, 2, 6, 4, 4, 9, 5, 5, 6],
          [1, 1, 1, 1, 6, 6, 2, 6, 2, 6, 4, 4, 6, 5, 5, 6],
          [1, 1, 1, 1, 6, 3, 2, 2, 2, 6, 4, 4, 6, 1, 1, 6],
          [1, 1, 1, 1, 6, 6, 2, 6, 2, 6, 6, 6, 6, 5, 1, 6],
          [3, 3, 3, 4, 6, 6, 2, 6, 2, 6, 2, 2, 6, 5, 1, 6],
          [3, 6, 6, 2, 6, 6, 2, 6, 2, 6, 2, 2, 6, 5, 5, 6],
          [3, 6, 6, 2, 6, 6, 2, 6, 2, 6, 1, 1, 6, 2, 2, 6],
          [3, 3, 3, 4, 6, 6, 2, 6, 2, 6, 1, 1, 6, 2, 4, 7],
          [1, 1, 1, 1, 6, 6, 2, 6, 2, 6, 2, 2, 6, 2, 4, 6],
          [2, 2, 2, 2, 6, 6, 2, 2, 2, 6, 6, 6, 6, 2, 4, 6],
          [2, 2, 2, 2, 6, 7, 2, 8, 2, 6, 6, 6, 6, 2, 2, 6]
        ];

        

        img.onload = function () {
          context.scale(2, 2);

          
          for(var i = 0; i < map.length; i++) {
            for(var j = 0; j < map[i].length; j++) {
               switch(map[i][j]) {
                case WATER:
                  water(j * TILE_SIZE, i * TILE_SIZE);
                  break;
                case BRICK:
                  brick(j * TILE_SIZE, i * TILE_SIZE);
                  break;
                case STONE:
                  stone(j * TILE_SIZE, i * TILE_SIZE)
                  break;
                case TREE:
                  tree(j * TILE_SIZE, i * TILE_SIZE)
                  break; 
                case LATTICE:
                  lattice(j * TILE_SIZE, i * TILE_SIZE)
                  break;
                case ROAD:
                  road(j * TILE_SIZE, i * TILE_SIZE)
                  break;
                case TANK:
                  tank(j * TILE_SIZE, i * TILE_SIZE)
                  break;
                case FLAG:
                  flag(j * TILE_SIZE, i * TILE_SIZE)
                  break;
                case ENEMY_TANK:
                  enemy_tank(j * TILE_SIZE, i * TILE_SIZE)
                  break;
              }
            }  
          }
        };

        function stone(x, y) {
          context.save();
          context.translate(x, y);
          context.drawImage(img, 109, 414, 8, 8, 0, 0, 8, 8);
          context.drawImage(img, 109, 414, 8, 8, 8, 0, 8, 8);
          context.drawImage(img, 109, 414, 8, 8, 0, 8, 8, 8);
          context.drawImage(img, 109, 414, 8, 8, 8, 8, 8, 8);
          context.restore();
        };

        function water(x, y) {
          context.save();
          context.translate(x, y);
          context.drawImage(img, 109, 423, 8, 8 , 0, 0, 8, 8);
          context.drawImage(img, 109, 423, 8, 8 , 8, 0, 8, 8);
          context.drawImage(img, 109, 423, 8, 8 , 0, 8, 8, 8);
          context.drawImage(img, 109, 423, 8, 8 , 8, 8, 8, 8);
          context.restore();
        }

        function brick(x, y) {
          context.save();
          context.translate(x, y);
          context.drawImage(img, 118, 414, 8, 8, 0, 0, 8, 8)
          context.drawImage(img, 118, 414, 8, 8, 8, 0, 8, 8)
          context.drawImage(img, 118, 414, 8, 8, 0, 8, 8, 8)
          context.drawImage(img, 118, 414, 8, 8, 8, 8, 8, 8)
          context.restore();
        }

        function tree(x, y) {
          context.save();
          context.translate(x, y)
          context.drawImage(img, 135, 423, 8, 8, 0, 0, 8, 8)
          context.drawImage(img, 135, 423, 8, 8, 8, 0, 8, 8)
          context.drawImage(img, 135, 423, 8, 8, 0, 8, 8, 8)
          context.drawImage(img, 135, 423, 8, 8, 8, 8, 8, 8)
          context.restore();
        }

        function lattice(x, y) {
          context.save();
          context.translate(x, y)
          context.drawImage(img, 145, 423, 8, 8, 0, 0, 8, 8)
          context.drawImage(img, 145, 423, 8, 8, 8, 0, 8, 8)
          context.drawImage(img, 145, 423, 8, 8, 0, 8, 8, 8)
          context.drawImage(img, 145, 423, 8, 8, 8, 8, 8, 8)
          context.restore();
        }

        function road(x, y) {
          context.save();
          context.translate(x, y)
          context.drawImage(img, 40, 420, 16, 16, 0, 0, 16, 16)
          context.restore();
        }
        function tank(x, y) {
          context.save();
          context.translate(x, y)
          context.drawImage(img, 36, 316, 16, 16, 0, 0, 16, 16)
          context.restore();
        }

        function flag(x, y) {
          context.save();
          context.translate(x, y)
          context.drawImage(img, 186, 369, 16, 16, 0, 0, 16, 16)
          context.restore();
        }

        function enemy_tank(x, y) {
          context.save();
          context.translate(x, y)
          context.drawImage(img, 144, 349, 16, 16, 0, 0, 16, 16)
          context.restore();
        }

        window.addEventListener('keydown',this.check,false);

        function check(e) {
          var code = e.keyCode;
          switch (code) {
            case 37: 
              context.clearRect(0, 0, canvas.width, canvas.height);
              context.drawImage(img, 52, 316, 16, 16, cx - TILE_SIZE, cy, TILE_SIZE, TILE_SIZE)
              cx -=TILE_SIZE;
            break;
            case 38: 
              context.clearRect(0, 0, canvas.width, canvas.height);
              context.drawImage(img, 36, 316, 16, 16, cx, cy - TILE_SIZE, TILE_SIZE, TILE_SIZE)
              cy -= TILE_SIZE;
            break;
            case 39: 
              context.clearRect(0, 0, canvas.width, canvas.height);
              context.drawImage(img, 3, 316, 16, 16, cx + TILE_SIZE, cy, TILE_SIZE, TILE_SIZE);
              cx += TILE_SIZE;
            break;
            case 40: 
               context.clearRect(0, 0, canvas.width, canvas.height);
                context.drawImage(img, 20, 316, 16, 16, cx, cy + TILE_SIZE, TILE_SIZE, TILE_SIZE);

                cy += TILE_SIZE;
            break;
          }
        }
    </script>
  </body> 
</html>